{
  "geoip-pipeline" : {
    "processors" : [
      {
        "grok" : {
          "if" : "ctx.log?.file?.path?.contains('glastopf')",
          "field" : "message",
          "patterns" : [
            "%{GREEDYDATA}(%{GREEDYDATA}) %{IP:source.ip} requested %{GREEDYDATA}"
          ],
          "ignore_missing" : true
        }
      },
      {
        "geoip" : {
          "field" : "source.ip",
          "target_field" : "source.geo",
          "ignore_missing" : true
        }
      }
    ],
    "on_failure" : [
      {
        "set" : {
          "field" : "error.message",
          "value" : "{{ _ingest.on_failure_message }}"
        }
      }
    ]
  }
}