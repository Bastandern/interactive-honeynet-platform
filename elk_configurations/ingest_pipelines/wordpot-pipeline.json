{
  "wordpot-pipeline" : {
    "processors" : [
      {
        "json" : {
          "field" : "message",
          "target_field" : "wordpot",
          "on_failure" : [
            {
              "set" : {
                "field" : "error.message",
                "value" : "JSON parsing error on message field"
              }
            }
          ]
        }
      },
      {
        "set" : {
          "if" : "ctx.wordpot != null",
          "field" : "event.dataset",
          "value" : "wordpot.http"
        }
      },
      {
        "rename" : {
          "if" : "ctx.wordpot != null",
          "field" : "wordpot.src_ip",
          "target_field" : "source.ip",
          "ignore_missing" : true
        }
      },
      {
        "rename" : {
          "if" : "ctx.wordpot != null",
          "field" : "wordpot.src_port",
          "target_field" : "source.port",
          "ignore_missing" : true
        }
      },
      {
        "rename" : {
          "if" : "ctx.wordpot != null",
          "field" : "wordpot.dest_port",
          "target_field" : "destination.port",
          "ignore_missing" : true
        }
      },
      {
        "geoip" : {
          "if" : "ctx.source?.ip != null",
          "field" : "source.ip",
          "target_field" : "source.geo",
          "ignore_missing" : true
        }
      },
      {
        "remove" : {
          "if" : "ctx.wordpot != null",
          "field" : "message"
        }
      }
    ]
  }
}